# ADR-001: Elección de base de datos

## Contexto

Necesitamos seleccionar una base de datos para almacenar los datos de la aplicación, incluyendo productos, usuarios, pedidos y carritos de compra. Los requisitos principales son:

- Flexibilidad en el esquema de datos para adaptarse a cambios futuros
- Buen rendimiento en operaciones de lectura/escritura
- Escalabilidad horizontal para soportar crecimiento
- Facilidad de integración con el stack tecnológico (Node.js/Express)
- Capacidad de despliegue en contenedores Docker

## Alternativas consideradas

### MongoDB (NoSQL - Orientada a documentos)

- Esquema flexible y dinámico
- Escalabilidad horizontal nativa
- Buena integración con Node.js a través de Mongoose
- Consultas limitadas para relaciones complejas

### PostgreSQL (SQL - Relacional)

- Integridad referencial robusta
- Consultas complejas eficientes
- Esquema rígido que requiere migraciones
- Escalabilidad vertical principalmente

### MySQL (SQL - Relacional)

- Ampliamente adoptado y documentado
- Buen rendimiento en lecturas
- Menos características avanzadas que PostgreSQL
- Escalabilidad horizontal limitada

## Decisión

Utilizaremos **MongoDB** como base de datos principal, desplegada mediante contenedores Docker.

### Justificación

1. **Flexibilidad del esquema**: Los documentos JSON permiten evolucionar el modelo de datos sin migraciones complejas
2. **Naturaleza de los datos**: Productos, carritos y pedidos se modelan naturalmente como documentos
3. **Escalabilidad**: El sharding nativo permite crecimiento horizontal
4. **Stack tecnológico**: Integración directa con Node.js y JavaScript en todo el stack
5. **Contenedorización**: MongoDB se integra fácilmente con Docker y Docker Compose
6. **Microservicios**: Facilita la arquitectura distribuida al permitir bases de datos independientes por servicio

## Estado

Aceptado

## Consecuencias

### Ventajas

- Flexibilidad para añadir o modificar campos sin afectar documentos existentes
- Excelente integración con Node.js/Express mediante Mongoose ODM
- Escalabilidad horizontal mediante replica sets y sharding
- Formato JSON nativo facilita el trabajo con APIs REST
- Despliegue simplificado mediante contenedores Docker
- Permite base de datos por microservicio si es necesario

### Desventajas

- Relaciones complejas entre entidades requieren modelado cuidadoso o múltiples consultas
- Joins limitados comparado con bases de datos relacionales
- Mayor consumo de almacenamiento por desnormalización de datos
- Requiere disciplina del equipo para mantener consistencia en esquemas
- Las transacciones multi-documento tienen limitaciones de rendimiento

### Impactos

- **Equipo de desarrollo**: Necesitará familiarizarse con el paradigma NoSQL y Mongoose
- **Infraestructura**: Requerirá configuración de replica sets para alta disponibilidad
- **Modelo de datos**: Deberá diseñarse para minimizar joins y favorecer la desnormalización
- **Testing**: Las pruebas deberán incluir contenedores MongoDB mediante Docker

## Notas

- Se utilizará Mongoose como ODM para definir esquemas y validaciones
- Se configurará Docker Compose para entornos de desarrollo locales
- Se implementarán índices apropiados para optimizar consultas frecuentes
- Se evaluará la necesidad de replica sets según los requisitos de disponibilidad